{"uid":"e95e9fb1b3c97d92","name":"test_add_customer[params3]","fullName":"WMS.Scripts.test_003_addCustomer.TestAddCustomer#test_add_customer","historyId":"369a793d9fafbd64bf294ff5cd788617","time":{"start":1717163950672,"stop":1717163950771,"duration":99},"description":"用户新增接口测试用例","descriptionHtml":"<p>用户新增接口测试用例</p>\n","status":"failed","statusMessage":"AssertionError: 插入数据接口出现BUG!","statusTrace":"self = <WMS.Scripts.test_003_addCustomer.TestAddCustomer object at 0x000002D7932239E0>\nparams = {'address': '香港', 'bankAccount': None, 'bankName': '北京支行', 'customerLevel': '一级', ...}\n\n    @allure.description(\"用户新增接口测试用例\")\n    @allure.severity(\"critical\")\n    @pytest.mark.parametrize(\"params\", YamlUtil.get_yaml(get_yaml_path(\"add_customer_data.yaml\")))\n    def test_add_customer(self, params):\n        resp = requests.post(url=\"http://192.168.10.128:9632/wms/customer\",\n                             json={\n                                 \"customerNo\": params[\"customerNo\"],\n                                 \"customerName\": params[\"customerName\"],\n                                 \"address\": params[\"address\"],\n                                 \"mobile\": params[\"mobile\"],\n                                 \"tel\": params[\"tel\"],\n                                 \"customerPerson\": params[\"customerPerson\"],\n                                 \"customerLevel\": params[\"customerLevel\"],\n                                 \"email\": params[\"email\"],\n                                 \"remark\": params[\"remark\"],\n                                 \"bankAccount\": params[\"bankAccount\"],\n                                 \"bankName\": params[\"bankName\"]\n                             },\n                             headers={\"Authorization\": TokenUtil.get_token()})\n        res = resp.json()\n        # 插入成功 返回1/符合预期\n        if isinstance(res, int):\n            if res == params[\"expect\"]:\n                sql_01 = f\"select * from wms_customer where customer_no = '{params['customerNo']}'\"\n                self.cursor.execute(sql_01)\n                if self.cursor.rowcount != 0:\n                    LoggerUtil.logger.info(f\"接口响应符合预期,用例执行成功,查询提交参数是:{params}\")\n                    sql_02 = f\"delete from wms_customer where customer_no = '{params[\"customerNo\"]}'\"\n                    self.cursor.execute(sql_02)\n                    self.conn.commit()\n                    # 删除成功代表测试成功\n                    assert self.cursor.rowcount != 0\n        # 插入成功 bug 返回1不符合预期情况\n            elif res != params[\"expect\"]:\n                sql_03 = f\"select * from wms_customer where customer_no = '{params['customerNo']}'\"\n                self.cursor.execute(sql_03)\n                # 如果能查到数据代表有问题\n                if self.cursor.rowcount != 0:\n                    LoggerUtil.logger.error(f\"接口响应不符合预期,用例执行失败!查询提交参数是:{params}\")\n                    sql_04 = f\"delete from wms_customer where customer_no = '{params[\"customerNo\"]}'\"\n                    self.cursor.execute(sql_04)\n                    self.conn.commit()\n>                   raise AssertionError(\"插入数据接口出现BUG!\")\nE                   AssertionError: 插入数据接口出现BUG!\n\nWMS\\Scripts\\test_003_addCustomer.py:65: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_xunit_setup_method_fixture_TestAddCustomer","time":{"start":1717163950666,"stop":1717163950671,"duration":5},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentsCount":0,"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"用户新增接口测试用例","status":"failed","statusMessage":"AssertionError: 插入数据接口出现BUG!","statusTrace":"self = <WMS.Scripts.test_003_addCustomer.TestAddCustomer object at 0x000002D7932239E0>\nparams = {'address': '香港', 'bankAccount': None, 'bankName': '北京支行', 'customerLevel': '一级', ...}\n\n    @allure.description(\"用户新增接口测试用例\")\n    @allure.severity(\"critical\")\n    @pytest.mark.parametrize(\"params\", YamlUtil.get_yaml(get_yaml_path(\"add_customer_data.yaml\")))\n    def test_add_customer(self, params):\n        resp = requests.post(url=\"http://192.168.10.128:9632/wms/customer\",\n                             json={\n                                 \"customerNo\": params[\"customerNo\"],\n                                 \"customerName\": params[\"customerName\"],\n                                 \"address\": params[\"address\"],\n                                 \"mobile\": params[\"mobile\"],\n                                 \"tel\": params[\"tel\"],\n                                 \"customerPerson\": params[\"customerPerson\"],\n                                 \"customerLevel\": params[\"customerLevel\"],\n                                 \"email\": params[\"email\"],\n                                 \"remark\": params[\"remark\"],\n                                 \"bankAccount\": params[\"bankAccount\"],\n                                 \"bankName\": params[\"bankName\"]\n                             },\n                             headers={\"Authorization\": TokenUtil.get_token()})\n        res = resp.json()\n        # 插入成功 返回1/符合预期\n        if isinstance(res, int):\n            if res == params[\"expect\"]:\n                sql_01 = f\"select * from wms_customer where customer_no = '{params['customerNo']}'\"\n                self.cursor.execute(sql_01)\n                if self.cursor.rowcount != 0:\n                    LoggerUtil.logger.info(f\"接口响应符合预期,用例执行成功,查询提交参数是:{params}\")\n                    sql_02 = f\"delete from wms_customer where customer_no = '{params[\"customerNo\"]}'\"\n                    self.cursor.execute(sql_02)\n                    self.conn.commit()\n                    # 删除成功代表测试成功\n                    assert self.cursor.rowcount != 0\n        # 插入成功 bug 返回1不符合预期情况\n            elif res != params[\"expect\"]:\n                sql_03 = f\"select * from wms_customer where customer_no = '{params['customerNo']}'\"\n                self.cursor.execute(sql_03)\n                # 如果能查到数据代表有问题\n                if self.cursor.rowcount != 0:\n                    LoggerUtil.logger.error(f\"接口响应不符合预期,用例执行失败!查询提交参数是:{params}\")\n                    sql_04 = f\"delete from wms_customer where customer_no = '{params[\"customerNo\"]}'\"\n                    self.cursor.execute(sql_04)\n                    self.conn.commit()\n>                   raise AssertionError(\"插入数据接口出现BUG!\")\nE                   AssertionError: 插入数据接口出现BUG!\n\nWMS\\Scripts\\test_003_addCustomer.py:65: AssertionError","steps":[],"attachments":[{"uid":"eaff81073292d73d","name":"log","source":"eaff81073292d73d.txt","type":"text/plain","size":432}],"parameters":[],"attachmentsCount":1,"shouldDisplayMessage":true,"stepsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"_xunit_setup_method_fixture_TestAddCustomer::0","time":{"start":1717163950774,"stop":1717163950774,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentsCount":0,"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"feature","value":"WMS仓管系统用户新增接口"},{"name":"severity","value":"critical"},{"name":"parentSuite","value":"WMS.Scripts"},{"name":"suite","value":"test_003_addCustomer"},{"name":"subSuite","value":"TestAddCustomer"},{"name":"host","value":"SunTianYi"},{"name":"thread","value":"18520-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"WMS.Scripts.test_003_addCustomer"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"params","value":"{'customerNo': 'wms0004', 'customerName': '林林', 'address': '香港', 'mobile': '13188966666', 'tel': '88878886', 'customerPerson': '13351888891', 'customerLevel': '一级', 'email': '1260205627@sina.com', 'remark': '新增数据', 'bankAccount': None, 'bankName': '北京支行', 'expect': 500}"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"critical","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"e95e9fb1b3c97d92.json","parameterValues":["{'customerNo': 'wms0004', 'customerName': '林林', 'address': '香港', 'mobile': '13188966666', 'tel': '88878886', 'customerPerson': '13351888891', 'customerLevel': '一级', 'email': '1260205627@sina.com', 'remark': '新增数据', 'bankAccount': None, 'bankName': '北京支行', 'expect': 500}"]}